<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snapchat Username Checker</title>
  <style>
    body {
      font-family: 'Avenir Next', 'Segoe UI', sans-serif;
      background-color: #FFFC00;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      color: #333;
    }
    
    .container {
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      width: 90%;
      max-width: 500px;
      padding: 30px;
      text-align: center;
    }
    
    h1 {
      color: #000;
      margin-bottom: 30px;
    }
    
    .logo {
      width: 60px;
      height: 60px;
      background-color: #FFFC00;
      border-radius: 12px;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0 auto 20px;
    }
    
    .ghost {
      font-size: 36px;
    }
    
    .input-group {
      position: relative;
      margin-bottom: 30px;
    }
    
    input {
      width: 100%;
      padding: 14px 20px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
      transition: all 0.3s;
    }
    
    input:focus {
      border-color: #FFFC00;
      outline: none;
      box-shadow: 0 0 0 3px rgba(255, 252, 0, 0.2);
    }
    
    button {
      background-color: #FFFC00;
      color: #000;
      border: none;
      border-radius: 8px;
      padding: 14px 28px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    button:hover {
      background-color: #E6E300;
      transform: translateY(-2px);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    .result {
      margin-top: 30px;
      padding: 20px;
      border-radius: 8px;
      font-weight: bold;
      display: none;
    }
    
    .available {
      background-color: #E3FCEF;
      color: #0F5132;
      border: 1px solid #A3E4C9;
    }
    
    .taken {
      background-color: #FEECEC;
      color: #842029;
      border: 1px solid #F5C2C7;
    }
    
    .loading {
      display: none;
      justify-content: center;
      margin: 20px 0;
    }
    
    .loading div {
      width: 10px;
      height: 10px;
      margin: 0 5px;
      background-color: #FFFC00;
      border-radius: 50%;
      animation: bounce 0.9s infinite alternate;
    }
    
    .loading div:nth-child(2) {
      animation-delay: 0.3s;
    }
    
    .loading div:nth-child(3) {
      animation-delay: 0.6s;
    }
    
    @keyframes bounce {
      to {
        transform: translateY(-10px);
      }
    }
    
    .error {
      color: #842029;
      font-size: 14px;
      margin-top: 5px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <div class="ghost">ðŸ‘»</div>
    </div>
    <h1>Snapchat Username Checker</h1>
    <div class="input-group">
      <input 
        type="text" 
        id="username" 
        placeholder="Enter Snapchat username" 
        autocomplete="off"
      >
      <div class="error" id="error-message">Please enter a valid username</div>
    </div>
    <button id="check-button">Check Availability</button>
    
    <div class="loading" id="loading">
      <div></div>
      <div></div>
      <div></div>
    </div>
    
    <div class="result" id="result"></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const usernameInput = document.getElementById('username');
      const checkButton = document.getElementById('check-button');
      const resultDiv = document.getElementById('result');
      const loadingDiv = document.getElementById('loading');
      const errorMessage = document.getElementById('error-message');
      
      // Function to validate username format
      function isValidUsername(username) {
        // Snapchat usernames can only contain letters, numbers, periods, hyphens, and underscores
        // Between 3-15 characters
        const regex = /^[a-zA-Z0-9._-]{3,15}$/;
        return regex.test(username);
      }
      
      // Function to check if a Snapchat username exists using fetch
      async function checkUsername(username) {
        try {
          // The URL to check - we'll use the public profile link format
          const url = `https://www.snapchat.com/add/${username}`;
          
          // Create a proxy URL to bypass CORS issues
          // We'll use a CORS proxy service to help with this check
          const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;
          
          // Fetch the page through the proxy
          const response = await fetch(proxyUrl);
          const data = await response.json();
          
          // If the page contains specific error messages, the username is likely available
          const pageContent = data.contents;
          
          // Check for indicators that the profile doesn't exist
          const doesNotExist = 
            pageContent.includes("Cannot find the user") || 
            pageContent.includes("Sorry! We couldn't find") || 
            pageContent.includes("This username doesn't exist") ||
            pageContent.includes("Page not found") ||
            pageContent.includes("no-profile") ||
            pageContent.includes("error-container");
          
          // Check for indicators that the profile exists
          const profileExists = 
            pageContent.includes("Add Friend") || 
            pageContent.includes("snapcode") || 
            pageContent.includes("This profile is private") ||
            pageContent.includes("bitmoji") ||
            pageContent.includes("profile-card");
          
          // Determine the result
          if (doesNotExist) {
            return { isTaken: false, message: "Username is available!" };
          } else if (profileExists) {
            return { isTaken: true, message: "Username is taken." };
          } else {
            // If we can't clearly determine, make our best guess
            // The presence of a Snapchat profile page generally indicates the username is taken
            return { isTaken: !pageContent.includes("error"), message: "Username status uncertain, but likely taken." };
          }
        } catch (error) {
          console.error("Error checking username:", error);
          throw new Error("Failed to check username availability");
        }
      }
      
      // Alternative fallback method using an image check
      async function checkUsernameByImage(username) {
        return new Promise((resolve) => {
          // Create an image object
          const img = new Image();
          
          // Set up load and error handlers
          img.onload = function() {
            // If the image loads, the profile exists
            resolve({ isTaken: true, message: "Username is taken." });
          };
          
          img.onerror = function() {
            // If the image fails to load, the profile likely doesn't exist
            resolve({ isTaken: false, message: "Username is available!" });
          };
          
          // Try to load the user's bitmoji or profile image
          // Add a cache-busting parameter to prevent caching
          const timestamp = new Date().getTime();
          img.src = `https://app.snapchat.com/web/deeplink/snapcode?username=${username}&type=SVG&bitmoji=1&t=${timestamp}`;
          
          // Set a timeout in case it hangs
          setTimeout(() => {
            resolve({ isTaken: false, message: "Username availability check timed out. Likely available." });
          }, 5000);
        });
      }
      
      // Add event listener to the button
      checkButton.addEventListener('click', async function() {
        const username = usernameInput.value.trim();
        
        // Reset UI
        resultDiv.style.display = 'none';
        errorMessage.style.display = 'none';
        
        // Validate username
        if (!isValidUsername(username)) {
          errorMessage.style.display = 'block';
          return;
        }
        
        // Show loading animation
        loadingDiv.style.display = 'flex';
        
        try {
          // Try our primary method first
          let result;
          try {
            result = await checkUsername(username);
          } catch (error) {
            // If the primary method fails, fallback to the image method
            console.log("Primary method failed, trying fallback method...");
            result = await checkUsernameByImage(username);
          }
          
          // Hide loading animation
          loadingDiv.style.display = 'none';
          
          // Display result
          resultDiv.style.display = 'block';
          
          if (result.isTaken) {
            resultDiv.textContent = `@${username} is already taken.`;
            resultDiv.className = 'result taken';
          } else {
            resultDiv.textContent = `@${username} is available!`;
            resultDiv.className = 'result available';
          }
        } catch (error) {
          console.error("All methods failed:", error);
          
          // Hide loading animation
          loadingDiv.style.display = 'none';
          
          // Display error
          resultDiv.style.display = 'block';
          resultDiv.textContent = 'Could not determine username availability. Please try again later.';
          resultDiv.className = 'result taken';
        }
      });
      
      // Also check on Enter key press
      usernameInput.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
          checkButton.click();
        }
      });
    });
  </script>
</body>
</html>
